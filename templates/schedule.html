<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard â€“ FitAura</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-green-100 to-blue-50 min-h-screen p-6">
  <h1 class="text-3xl text-center font-bold text-emerald-700 mb-6">ğŸŒŸ FitAura Dashboard</h1>

  <!-- Water Tracker -->
  <section class="bg-white p-6 rounded-lg shadow-lg mb-6 border max-w-md mx-auto">
    <h2 class="text-xl font-semibold text-blue-700 mb-2">ğŸ’§ Water Intake</h2>
    <p class="mb-4 text-gray-700">You've had <strong>{{ water }}</strong> glasses today!</p>
    <form method="POST" class="space-x-2">
      <button name="add_water" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">+ Add Glass</button>
      <button name="reset_water" class="bg-gray-300 px-4 py-2 rounded hover:bg-gray-400">Reset</button>
    </form>
  </section>

  <!-- Mood Quote -->
  <section class="bg-white p-6 rounded-lg shadow-lg mb-6 border max-w-md mx-auto">
    <h2 class="text-xl font-semibold text-emerald-700 mb-2">ğŸ˜Š Your Daily Quote</h2>
    <p class="text-lg italic text-gray-700">â€œ{{ quote }}â€</p>
  </section>

  <!-- To-Do List -->
  <section class="bg-white p-6 rounded-lg shadow-lg border max-w-md mx-auto">
    <h2 class="text-xl font-semibold text-indigo-700 mb-4">ğŸ“‹ To-Do List</h2>
    <form method="POST" class="mb-4 space-y-2">
      <input name="task" type="text" placeholder="Enter task..." required class="w-full px-3 py-2 border rounded" />
      <input name="date" type="date" required class="w-full px-3 py-2 border rounded" />
      <button type="submit" class="w-full bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700">Add Task</button>
    </form>
    <ul class="space-y-2">
      {% for item in todos %}
        <li class="bg-indigo-50 border px-4 py-2 rounded">
          âœ… <strong>{{ item.task }}</strong> on {{ item.date }}
        </li>
      {% endfor %}
    </ul>
  </section>

  <!-- Embed To-Do JSON for JS notifications -->
  <script id="todo-data" type="application/json">
    {{ todos | tojson | safe }}
  </script>

  <!-- Task Reminder Notification Script -->
  <script>
    // Ask permission for notifications
    if ("Notification" in window && Notification.permission !== "granted") {
      Notification.requestPermission();
    }

    const todos = JSON.parse(document.getElementById("todo-data").textContent || "[]");

    setInterval(() => {
      const today = new Date().toISOString().split("T")[0];
      todos.forEach(todo => {
        if (todo.date === today && Notification.permission === "granted") {
          new Notification("ğŸ“ Task Reminder", {
            body: `Don't forget: ${todo.task}`,
            icon: "https://img.icons8.com/emoji/48/alarm-clock-emoji.png"
          });
        }
      });
    }, 60000); // Check every 1 min
  </script>
</body>
</html>

